# Test task for Genesis Kismia - Data Scientist


### Краткое описание

Провести ресерч, натренировать модель
Дополнительное задание - написать Python-скрипт

### Описание

Представь что ты Data Scientist на проекте где подписочная модель монетизации.
На проекте существует модель прогнозирования которая высчитывает вероятность того, что продление подписки будет успешным. Главная ее задача как можно точнее прогнозировать доход от запланированных автопродлений подписки (рекурентов)

Тебе дали задание проанализировать и дать ответы на вопросы:
1) Что больше всего влияет на успешность продления подписки?
2) Какие есть проблемы у текущей модели?
3) Как лучше всего оценивать модель?

А также построить собственную модель прогнозирования.

Важно:
- Ход мыслей, итоги анализа, ход обучения модели и ее результат обязательно предоставить в Jupyter Notebook
- Модель сохранить и отправить вместе с Jupyter Notebook.
- Код должен быть написан так, чтобы можно было воспроизвести модель на другом устройстве.
- Модель должна быть бизнес ориентирована 

Любые дополнительные найденные "инсайты" и ресерчи приветствуются!

### Исходные данные

В качестве исходных данных вам предоставлена выгрузка логов работы прогноза, в которых содержаться данные о подписках пользователей и о них самих в разные моменты времени. Файл data_science_dataset_test_task.csv

### Структура данных

| current\_dt             | timestamp   | в какой момент времени была собрана информация                                                                                                                                                         |
| ----------------------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| user\_id                | id          | уникальный индефикатор пользователя                                                                                                                                                                    |
| scheduled\_dt           | timestamp   | дата на которую запланировано автопродление                                                                                                                                                            |
| root\_order\_id         | id          | уникальный индефикатор подписки                                                                                                                                                                        |
| gender                  | categorical | пол пользователя                                                                                                                                                                                       |
| age                     | categorical | возраст пользователя                                                                                                                                                                                   |
| os\_family              | categorical | операционная система пользователя                                                                                                                                                                      |
| lt\_user                | nominal     | lifetime пользователя                                                                                                                                                                                  |
| hours\_after\_reg\_buy  | nominal     | через сколько часов после регистрации пользователь оформил подписку                                                                                                                                    |
| country\_code           | categorical | страна пользователя                                                                                                                                                                                    |
| phone                   | categorical | марка телефона пользователя                                                                                                                                                                            |
| cpa                     | nominal     | СPA по которому был привлечен пользователь                                                                                                                                                             |
| retry\_number           | nominal     | номер попытки автопродлить подписку                                                                                                                                                                    |
| period                  | categorical | на какой период оформлена подписка                                                                                                                                                                     |
| gross                   | nominal     | сколько стоит продление подписки                                                                                                                                                                       |
| currency\_id            | categorical | валюта в какой оформлена подписка                                                                                                                                                                      |
| discount                | nominal     | размер скидки на продление                                                                                                                                                                             |
| psp                     | categorical | платежный шлюз                                                                                                                                                                                         |
| last\_response\_code    | categorical | при неудачных попытках автопродлить подписку платежный сервис отдает причину неудачи (response\_code). last\_response\_code говорит какой был ответ при прошлой попытке продлить подписку пользователю |
| bank                    | categorical | банк в котором оформлена карта пользователя                                                                                                                                                            |
| was\_3ds                | binary      | проходило ли оформление подписки через 3D Secure                                                                                                                                                       |
| card\_type              | categorical | тип карты                                                                                                                                                                                              |
| card\_country\_code     | categorical | страна оформления карты                                                                                                                                                                                |
| success\_orders         | nominal     | количество успешных оплат пользователя                                                                                                                                                                 |
| not\_success\_orders    | nominal     | количество не успешных оплат пользователя                                                                                                                                                              |
| insufficients           | nominal     | количество не успешных оплат пользователя по причине недостаточного количества средств на карте                                                                                                        |
| root\_gross             | nominal     | на какую сумму пользователь уже оформил данную подписку                                                                                                                                                |
| not\_root\_gross        | nominal     | какую сумму пользователь потратил без учета данной подписки                                                                                                                                            |
| old\_model\_probability |             | вероятность успешного продления данной подписки, которое отдает старая модель                                                                                                                          |
| is\_success             |             | результат - произошло ли продление подписки                                                                                                                                                            |



### Дополнительное задание

Ты Data Scientist и тебе нужно написать программу, которая будет выгружать нужные данные из базы данных, для них просчитывать прогноз (на основе построеной тобой модели) и возращать данные вместе с прогнозом обратно в БД

1. На основе Задания 2 построить схему базы даных  
2. Написать Python-скрипт который загрузит данные из файла (без полей old_model_probability, is_success) в БД
3. Написать Python-скрипт который выгрузит данные из таблицы, подсчитает прогнозные значения и загрузит данные + прогноз обратно в БД 
(После запуска двух скриптов в базе должно быть две таблицы: первая - данные из файла, вторая - данные из файла+прогноз)